<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
	<title>weather Station</title>
	<meta charset="utf-8">

<style>
	img {
	  filter: brightness(50%);
	}
</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
	let ip = "http://172.16.3.6";
	let data = {};
	$(document).ready(function(){
		getData();
	  	$("#green").click(function(){
	  		document.getElementById("green").innerHTML = "Loading..."; 
		    $.get(`${ip}/green`, function(data, status){
		    	document.getElementById("green").innerHTML = "Green"; 
		    });
		});
		$("#automatic").click(function(){
			let enable;
			if (data.automatic === "1") {
				enable = false;
			}else{
				enable = true;
			}
	  		document.getElementById("automatic").innerHTML = "Loading..."; 
		    $.get(`${ip}/auto?on=${enable}`, function(data, status){
		    	getData();
		    });
		});
		$("#blue").click(function(){
		    document.getElementById("blue").innerHTML = "Loading...";
		    $.get(`${ip}/blue`, function(data, status){
		      document.getElementById("blue").innerHTML = "Blue"; 
		    });
		});
		$("#red").click(function(){
			document.getElementById("red").innerHTML = "Loading...";
		    $.get(`${ip}/red`, function(data, status){
		      document.getElementById("red").innerHTML = "Red"; 
		    });
		});
		$("#white").click(function(){
			document.getElementById("white").innerHTML = "Loading...";
		    $.get(`${ip}/white`, function(data, status){
		      document.getElementById("white").innerHTML = "White"; 
		    });
		});
	});
	function getData() {
		$.get(`${ip}/data`, function(arduinoData, status){
		    data = arduinoData;
		    console.log(data);
		    document.getElementById("indoor").innerHTML = `Temperature: ${data.indoor.temperature}°C Humidity: ${data.indoor.humidity}%`; 
			document.getElementById("outdoor").innerHTML = `Temperature: ${data.outdoor.temperature}°C Humidity: ${data.outdoor.humidity}%`; 
			if (data.automatic === "1") {
				document.getElementById("automatic").innerHTML = `Disable automatic`; 
				document.getElementById("green").disabled = true;
				document.getElementById("blue").disabled = true;
				document.getElementById("red").disabled = true;
				document.getElementById("white").disabled = true;
			}else{
				document.getElementById("automatic").innerHTML = `Enable automatic`; 
				document.getElementById("green").disabled = false;
				document.getElementById("blue").disabled = false;
				document.getElementById("red").disabled = false;
				document.getElementById("white").disabled = false;
			}
			document.getElementById('date_indoor').innerHTML = new Date().toLocaleString();
			document.getElementById('date_outdoor').innerHTML = new Date().toLocaleString();
		});
	}
</script>
</head>
<body id="body">

<!--Navbar-->
	<nav class="navbar navbar-expand-lg navbar-light bg-light">
	  <a class="navbar-brand" href="#">Weather Station</a>
	  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
	    <span class="navbar-toggler-icon"></span>
	  </button>

	  <div class="collapse navbar-collapse" id="navbarSupportedContent">
	    <ul class="navbar-nav mr-auto"></ul>
	    <div class="form-inline my-2 my-lg-0">
	    	<button id="green" style="margin-left: 5px;" class="btn btn-outline-success my-2 my-sm-0">Green</button>		
	    	<button id="blue" style="margin-left: 5px;" class="btn btn-outline-primary my-2 my-sm-0" type="submit">Blue</button>
	    	<button id="red" style="margin-left: 5px;" class="btn btn-outline-danger my-2 my-sm-0" type="submit">Red</button>
	    	<button id="white" style="margin-left: 5px;" class="btn btn-outline-dark my-2 my-sm-0" type="submit">White</button>
	    	<button id="automatic" style="margin-left: 35px;" class="btn btn-outline-warning my-2 my-sm-0" type="submit">Loading...</button>
	    </div>
	  </div>
	</nav>
	
	</br></br></br></br></br></br>
	<div class="container">
  		<div class="row">
    		<div class="col">
    			<div class="card bg-dark text-white" style="width: 31rem;">
			  		<img src="https://sf2.viepratique.fr/wp-content/uploads/sites/8/2017/04/comment-amenager-l-interieur-de-sa-maison-en-bois-750x410.jpg" class="img-fluid card-img" alt="Indoor">
			  		<div class="card-img-overlay">
			  		<h5 class="card-title">Last update: <span id="date_indoor"></span></h5>
			    	<p id="indoor" class="card-text">Loading...</p>
			  		</div>
				</div>
    		</div>
    		<div class="col">
    	 		<div class="card bg-dark text-white" style="width: 31rem;">
			  		<img src="https://geo.img.pmdstatic.net/fit/https.3A.2F.2Fwww.2Ecaminteresse.2Efr.2Fcontent.2Fuploads.2F2018.2F02.2Fciel.2Ejpg/750x422/quality/80/background-color/ffffff/background-alpha/100/focus-point/375%2C211/crop-zone/0%2C0-750x422/ciel.jpg" class="img-fluid card-img" alt="Outdoor">
					<div class="card-img-overlay">
			  		<h5 class="card-title">Last update: <span id="date_outdoor"></span></h5>
			    	<p id="outdoor" class="card-text">Loading...</p>
				</div>
  				</div>
			</div>
		</div>
	</div>

	</br></br>

	<script src="https://code.jquery.crossorigim/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
	
</body>
</html>